<mat-toolbar color="primary">
  <mat-icon>assignment</mat-icon>
  &nbsp; Phase d'Initiation > {{ steps[currentStep] }}
</mat-toolbar>

<div class="wizard-container">
  <!-- Étape 1 : Introduction -->
  <!-- Étape 1 : Introduction / Objectifs -->
<section *ngIf="currentStep === 0">
  <h1>Phase d'Initiation du Projet</h1>
  <p>Cette phase est cruciale pour définir les objectifs, les exigences et établir un plan.</p>

  <form (ngSubmit)="next()" #introForm="ngForm">
    <!-- Champ Introduction -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Introduction</mat-label>
      <textarea
        matInput
        name="introduction"
        required
        rows="3"
        placeholder="Présentez brièvement le projet"
        [(ngModel)]="introduction">
      </textarea>
    </mat-form-field>

    <!-- Champ Objectifs -->
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Objectifs</mat-label>
      <textarea
        matInput
        name="objectifs"
        required
        rows="3"
        placeholder="Listez les objectifs principaux"
        [(ngModel)]="objectifs">
      </textarea>
    </mat-form-field>

    <div class="nav-buttons">
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="introForm.form.invalid">
        Commencer
      </button>
    </div>
  </form>
</section>


  <!-- Étape 2 : Recueil des exigences -->
  <section *ngIf="currentStep === 1">
    <h2>Recueil des Exigences</h2>

    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Fonctionnelle</mat-label>
      <textarea matInput [(ngModel)]="newExigence.fonctionnelle"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Non fonctionnelle</mat-label>
      <textarea matInput [(ngModel)]="newExigence.nonFonctionnelle"></textarea>
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Priorité</mat-label>
      <mat-select [(ngModel)]="newExigence.priorite">
        <mat-option value="HAUTE">Haute</mat-option>
        <mat-option value="MOYENNE">Moyenne</mat-option>
        <mat-option value="BASSE">Basse</mat-option>
      </mat-select>
    </mat-form-field>

    <button mat-button (click)="addExigence()">Ajouter</button>

    <table *ngIf="exigences.length" class="mat-elevation-z2" style="width:100%; margin:16px 0;">
      <tr *ngFor="let ex of exigences; let i = index">
        <td>{{ ex.fonctionnelle }}</td>
        <td>{{ ex.nonFonctionnelle }}</td>
        <td>{{ ex.priorite }}</td>
        <td>
          <button mat-icon-button color="warn" (click)="removeExigence(i)">
            <mat-icon>delete</mat-icon>
          </button>
        </td>
      </tr>
    </table>

    <div class="nav-buttons">
      <button mat-button (click)="prev()">Retour</button>
      <button mat-raised-button color="primary" [disabled]="exigences.length===0" (click)="next()">
        Suivant
      </button>
    </div>
  </section>

  <!-- Étape 3 : Analyse de faisabilité -->
  <section *ngIf="currentStep === 2">
    <h2>Analyse de Faisabilité</h2>
    <mat-checkbox [(ngModel)]="faisabilite.techniqueDisponible">Les technologies nécessaires sont disponibles ?</mat-checkbox><br>
    <mat-checkbox [(ngModel)]="faisabilite.budgetSuffisant">Le budget estimé est-il suffisant ?</mat-checkbox><br>
    <mat-checkbox [(ngModel)]="faisabilite.delaisRealistes">Les délais sont-ils réalistes ?</mat-checkbox><br>
    <mat-checkbox [(ngModel)]="faisabilite.ressourcesHumainesSuffisantes">Les ressources humaines sont-elles suffisantes ?</mat-checkbox><br>

    <div class="nav-buttons">
      <button mat-button (click)="prev()">Retour</button>
      <button mat-raised-button color="primary" (click)="onAnalyze()">Suivant</button>
    </div>
  </section>

  <!-- Étape 4 : Cahier des charges -->
  <section *ngIf="currentStep === 3">
    <h2>Cahier des charges</h2>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Objectifs</mat-label>
      <textarea matInput [(ngModel)]="cahier.objectifsProjet"></textarea>
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Livrables</mat-label>
      <textarea matInput [(ngModel)]="cahier.livrables"></textarea>
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Contraintes</mat-label>
      <textarea matInput [(ngModel)]="cahier.contraintes"></textarea>
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Critères de succès</mat-label>
      <textarea matInput [(ngModel)]="cahier.criteresSucces"></textarea>
    </mat-form-field>

    <div class="nav-buttons">
      <button mat-button (click)="prev()">Retour</button>
      <button mat-raised-button color="primary" (click)="onValiderCahier()">Suivant</button>
    </div>
  </section>

  <!-- Étape 5 : Planification -->
  <section *ngIf="currentStep === 4">
    <h2>Planification du Projet</h2>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Nom de la phase</mat-label>
      <input matInput [(ngModel)]="newPlanning.nomPhase">
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Date de début</mat-label>
      <input matInput type="date" [(ngModel)]="newPlanning.dateDebut">
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Date de fin</mat-label>
      <input matInput type="date" [(ngModel)]="newPlanning.dateFin">
    </mat-form-field>
    <mat-form-field appearance="fill" class="w-100">
      <mat-label>Budget estimé</mat-label>
      <input matInput type="number" [(ngModel)]="newPlanning.budgetEstime">
    </mat-form-field>

    <div class="nav-buttons">
      <button mat-button (click)="prev()">Retour</button>
      <button mat-raised-button color="primary" (click)="onPlanifier()">Planifier</button>
    </div>
  </section>
</div>
