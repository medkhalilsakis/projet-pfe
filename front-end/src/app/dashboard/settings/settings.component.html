<mat-card id="settings-card" class="settings-card">
  <mat-card-title id="settings-title" class="settings-title">Mes Paramètres</mat-card-title>

  <mat-card-content id="settings-content" class="settings-content">
    <div id="avatar-section" class="avatar-section">
      <img
        *ngIf="previewUrl; else showStored"
        [src]="previewUrl"
        id="avatar-preview"
        class="avatar avatar-preview">

      <ng-template #showStored>
        <img
          *ngIf="profileImageUrl; else placeholder"
          [src]="profileImageUrl"
          id="avatar-stored"
          class="avatar avatar-stored">
      </ng-template>

      <ng-template #placeholder>
        <mat-icon id="avatar-placeholder" class="avatar avatar-placeholder">person</mat-icon>
      </ng-template>

      <input
        #fileInput
        id="avatar-input"
        class="avatar-input"
        type="file"
        accept="image/*"
        hidden
        (change)="onFileSelected($event)">

      <button
        mat-mini-fab
        id="avatar-btn-select"
        class="btn-select-avatar"
        color="primary"
        (click)="fileInput.click()">
        <mat-icon>photo_camera</mat-icon>
      </button>
    </div>

    <button
      mat-raised-button
      id="avatar-btn-upload"
      class="btn-upload-avatar"
      color="accent"
      (click)="uploadImage()"
      [disabled]="!selectedFile || uploadInProgress">
      {{ uploadInProgress ? 'Chargement…' : 'Enregistrer Photo' }}
    </button>

    <form
      [formGroup]="userForm"
      id="profile-form"
      class="profile-form">
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Nom</mat-label>
          <input matInput formControlName="nom">
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Prénom</mat-label>
          <input matInput formControlName="prenom">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email">
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Username</mat-label>
          <input matInput formControlName="username">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>NCIN</mat-label>
          <input matInput formControlName="ncin">
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Mot de passe</mat-label>
          <input matInput type="password" formControlName="password">
        </mat-form-field>
      </div>
    </form>
  </mat-card-content>

  <mat-card-actions id="settings-actions" class="settings-actions" align="end">
    <button
      mat-raised-button
      id="btn-save-profile"
      class="btn-save-profile"
      color="primary"
      (click)="saveProfile()">
      Enregistrer
    </button>
  </mat-card-actions>
</mat-card>
