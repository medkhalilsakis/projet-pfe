<!-- src/app/dashboard/project-files/project-files.component.html -->
<mat-toolbar color="primary" class="toolbar">
  <button mat-icon-button (click)="onClose()">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <span class="toolbar-title">{{ data.project.name }}</span>
  <span class="spacer"></span>
  <button mat-raised-button color="accent" (click)="openNewFolderDialog()">
    <mat-icon>create_new_folder</mat-icon>
    Nouveau dossier
  </button>
  <button mat-icon-button matTooltip="Uploader des fichiers" (click)="fileInput.click()">
    <mat-icon>upload_file</mat-icon>
  </button>
  <input #fileInput type="file" multiple (change)="onFilesSelected($event)" hidden>
</mat-toolbar>

<div class="container">
  <nav class="breadcrumb">
    <ng-container *ngFor="let bc of breadcrumbs; let last=last">
      <a *ngIf="!last" (click)="navigateTo(bc)">{{ bc.name }}</a>
      <span *ngIf="last" class="current">{{ bc.name }}</span>
      <mat-icon *ngIf="!last" class="sep">chevron_right</mat-icon>
    </ng-container>
  </nav>

  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Recherche dans « {{ breadcrumbs[breadcrumbs.length-1].name }} »</mat-label>
    <input matInput [(ngModel)]="searchTerm" (ngModelChange)="filterFiles()">
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <mat-progress-bar *ngIf="uploading"
    mode="determinate" [value]="progress"
    class="upload-bar">
  </mat-progress-bar>

  <div class="grid">
    <div class="file-tile" *ngFor="let f of files" (dblclick)="onItemClick(f)">
      <mat-icon class="file-icon">
        {{ f.type==='FOLDER' ? 'folder' : 'insert_drive_file' }}
      </mat-icon>
      <div class="file-name">{{ getDisplayName(f.name) }}</div>
    </div>
  </div>
</div>
