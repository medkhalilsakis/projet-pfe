<mat-card class="user-mgmt-card">
  <mat-card-title class="um-title">Gestion des utilisateurs</mat-card-title>
  <mat-card-content class="um-content">

    <!-- Controls -->
    <div
      class="um-controls"
      fxLayout="row"
      fxLayout.xs="column"
      fxLayoutAlign="space-between center"
      fxLayoutGap="1rem"
    >
      <mat-form-field appearance="outline" class="um-search-field" fxFlex="1 1 300px">
        <mat-label>Rechercher</mat-label>
        <input
          matInput
          class="um-search-input"
          (keyup)="applyFilter($event)"
          placeholder="Nom, email …"
        >
      </mat-form-field>

      <button
        mat-flat-button
        color="primary"
        class="um-add-btn"
        (click)="onAdd()"
        fxFlex="0 0 auto"
      >
        + Ajouter
      </button>
    </div>

    <!-- Tableau -->
    <div fxFlexFill fxLayout="column" class="um-table-container">
      <table
        mat-table
        [dataSource]="dataSource"
        matSort
        class="um-table mat-elevation-z2"
      >

        <!-- 1. Titre -->
        <ng-container matColumnDef="titre">
          <th mat-header-cell *matHeaderCellDef class="um-header titre">Titre</th>
          <td mat-cell *matCellDef="let u" class="um-cell titre">{{u.titre}}</td>
        </ng-container>

        <!-- 2. Avatar -->
        <ng-container matColumnDef="avatar">
          <th mat-header-cell *matHeaderCellDef class="um-header avatar">Photo</th>
          <td mat-cell *matCellDef="let u" class="um-cell avatar">
            <img [src]="u.avatarUrl" class="um-avatar" alt="avatar">
          </td>
        </ng-container>

        <!-- 3. Nom -->
        <ng-container matColumnDef="nom">
          <th mat-header-cell *matHeaderCellDef class="um-header nom">Nom</th>
          <td mat-cell *matCellDef="let u" class="um-cell nom">{{u.nom}}</td>
        </ng-container>

        <!-- 4. Prénom -->
        <ng-container matColumnDef="prenom">
          <th mat-header-cell *matHeaderCellDef class="um-header prenom">Prénom</th>
          <td mat-cell *matCellDef="let u" class="um-cell prenom">{{u.prenom}}</td>
        </ng-container>

        <!-- 5. NCIN -->
        <ng-container matColumnDef="ncin">
          <th mat-header-cell *matHeaderCellDef class="um-header ncin">NCIN</th>
          <td mat-cell *matCellDef="let u" class="um-cell ncin">{{u.ncin}}</td>
        </ng-container>

        <!-- 6. Email -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef class="um-header email">Email</th>
          <td mat-cell *matCellDef="let u" class="um-cell email">{{u.email}}</td>
        </ng-container>

        <!-- 7. Date d'embauche -->
        <ng-container matColumnDef="dateEmbauche">
          <th mat-header-cell *matHeaderCellDef class="um-header date">Embauché le</th>
          <td mat-cell *matCellDef="let u" class="um-cell date">{{u.dateEmbauche | date:'shortDate'}}</td>
        </ng-container>

        <!-- 8. Salaire -->
        <ng-container matColumnDef="salaire">
          <th mat-header-cell *matHeaderCellDef class="um-header salaire">Salaire</th>
          <td mat-cell *matCellDef="let u" class="um-cell salaire">{{u.salaire | currency}}</td>
        </ng-container>

        <!-- 9. Rôle -->
        <ng-container matColumnDef="role">
          <th mat-header-cell *matHeaderCellDef class="um-header role">Rôle</th>
          <td mat-cell *matCellDef="let u" class="um-cell role">{{u.role.libelle}}</td>
        </ng-container>

        <!-- 10. Actions -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="um-header actions">Actions</th>
          <td mat-cell *matCellDef="let u" class="um-cell actions">
            <button mat-icon-button class="um-icon-btn edit" color="primary" (click)="onEdit(u)"    matTooltip="Éditer">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button class="um-icon-btn delete" color="warn"    (click)="onDelete(u)"  matTooltip="Supprimer">
              <mat-icon>delete</mat-icon>
            </button>
            <button mat-icon-button class="um-icon-btn analytics" color="accent"  (click)="onAnalytics(u)" matTooltip="Performance">
              <mat-icon>insights</mat-icon>
            </button>
            <button mat-icon-button class="um-icon-btn message" (click)="onMessage(u)"   matTooltip="Message">
              <mat-icon>message</mat-icon>
            </button>
          </td>
        </ng-container>

        <!-- Rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="um-header-row"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="um-row"></tr>
      </table>

      <!-- Paginator -->
      <div fxLayout="row" fxLayoutAlign="end center" class="um-paginator-container">
        <mat-paginator [pageSizeOptions]="[5,10,20]" showFirstLastButtons class="um-paginator">
        </mat-paginator>
      </div>
    </div>

  </mat-card-content>
</mat-card>
